/*
   插件名称：越权访问
   插件描述：利用 Cookie 替换测试是否存在越权漏洞。首先在关闭插件的情况下登录 a 账号，利用 b 账号的凭据（Cookie/Session）
             替换插件中的相应字段，测试 a 的逻辑功能是否可以执行，可以执行即存在越权漏洞。
*/

module.exports = {
    *beforeSendRequest(requestDetail) {
        if (requestDetail.url.indexOf('http://httpbin.org') === 0) {
            const newRequestOptions = requestDetail.requestOptions;
            newRequestOptions.headers['Cookie'] = 'xxxxxx';
            return {
                requestOptions: newRequestOptions
            };
        }
    },
};
